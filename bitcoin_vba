
Option Explicit

Private Declare Function URLDownloadToFile Lib "urlmon" _
Alias "URLDownloadToFileA" (ByVal pCaller As Long, _
ByVal szURL As String, ByVal szFileName As String, _
ByVal dwReserved As Long, ByVal lpfnCB As Long) As Long
Dim Ret As Long
Const strFileName = "C:\Temp\bitcoin"
Const dataTable = "data"

Sub Download()
' QuandlData()
' strFileName is already set as a constant

Dim URL As String

    URL = "https://www.quandl.com/api/v3/datasets/BITCOIN/BTCEUSD.csv?api_key=P6QLMV4K3VrkT3jsdCP1"
    
    Ret = URLDownloadToFile(0, URL, strFileName, 0, 0)
    
        If Ret = 0 Then
            MsgBox "File successfully downloaded"
            Else: MsgBox "Unable to download the file"
        End If
        
End Sub

Sub OpenData()


' remember that strFileName is set as a constant

Workbooks.OpenText Filename:=strFileName, DataType:=xlDelimited, Comma:=False
'_ DecimalSeparator:="." ', ThousandsSeparator:="." ', Local:=False
ActiveWorkbook.SaveAs Filename:=strFileName, FileFormat:= _
        xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False



End Sub
   

Sub SetRange()
 ' dataTable is already announced as a constant

     
Range("A1").Select
Range(Selection, Selection.End(xlToRight)).Select
Range(Selection, Selection.End(xlDown)).Select

ActiveSheet.ListObjects.Add(xlSrcRange, , , xlYes).Name = _
        dataTable
        
    Range(dataTable & "[#All]").Select
    
    ActiveSheet.ListObjects(dataTable).TableStyle = "TableStyleMedium6"
 
End Sub

Sub sortDate()
Dim sortField As String

sortField = "Date"

    Range(dataTable).Sort _
        Key1:=Range(dataTable & "[" & sortField & "]"), Header:=xlYes


End Sub

Sub nSize()

' here we need to define the number of observations to the latest 365
' so we count total number of lines and subtract by 365


End Sub





