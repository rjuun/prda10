Option ExplicitPrivate Declare Function URLDownloadToFile Lib "urlmon" _Alias "URLDownloadToFileA" (ByVal pCaller As Long, _ByVal szURL As String, ByVal szFileName As String, _ByVal dwReserved As Long, ByVal lpfnCB As Long) As LongDim Ret As LongSub DownloadQuandlData()    Dim URL As String    Dim Path As String        URL = "https://www.quandl.com/api/v3/datasets/BITCOIN/BTCEUSD.csv?api_key=P6QLMV4K3VrkT3jsdCP1"        Path = "C:\Users\fhb160157\Downloads\bitcoin.csv"        Ret = URLDownloadToFile(0, URL, Path, 0, 0)        If Ret = 0 Then                MsgBox "File successfully downloaded"            Else                MsgBox "Unable to download the file"        End IfEnd SubSub ImportCSV()    Const strFileName = "C:\Users\fhb160157\Downloads\bitcoin.csv"    Dim wbkS As Workbook    Dim wshS As Worksheet    Dim wshT As Worksheet            Set wshT = Worksheets.Add(After:=Worksheets(Worksheets.Count))        Set wbkS = Workbooks.Open(filename:=strFileName, Format:=",")        Set wshS = wbkS.Worksheets(1)            wshS.Range("A1:A8").EntireRow.Delete            wshS.UsedRange.Copy Destination:=wshT.Range("A1")            wbkS.Close SaveChanges:=FalseEnd SubSub OpenData()Application.DecimalSeparator = ","Const strFileName = "C:\Users\fhb160157\Downloads\bitcoin.csv"Dim wb As WorkbookSet wb = Workbooks.Open(strFileName)End Sub
