
Option Explicit

Private Declare Function URLDownloadToFile Lib "urlmon" _
Alias "URLDownloadToFileA" (ByVal pCaller As Long, _
ByVal szURL As String, ByVal szFileName As String, _
ByVal dwReserved As Long, ByVal lpfnCB As Long) As Long
Dim Ret As Long

Sub Download()
'QuandlData()
Dim URL As String
Dim Path As String
    URL = "https://www.quandl.com/api/v3/datasets/BITCOIN/BTCEUSD.csv?api_key=P6QLMV4K3VrkT3jsdCP1"
    Path = "C:\Temp\bitcoin.csv"
    Ret = URLDownloadToFile(0, URL, Path, 0, 0)
        If Ret = 0 Then
            MsgBox "File successfully downloaded"
        Else: MsgBox "Unable to download the file"
        End If
End Sub




Sub OpenData()
Application.DecimalSeparator = ","
Const strFileName = "C:\Temp\bitcoin.csv"
Dim wb As Workbook

Set wb = Workbooks.Open(Filename:=strFileName, Format:=2)
    ActiveWorkbook.SaveAs Filename:="C:\Temp\bitcoin", FileFormat:= _
        xlOpenXMLWorkbookMacroEnabled, CreateBackup:=False



End Sub


Sub ImportWorksheet()
Dim ControlFile As String

Const strFileName = "C:\Temp\bitcoin.csv"
    ' This macro will import a file into this workbook
    
    Sheets("Sheet1").Select
    
    
    ControlFile = ActiveWorkbook.Name
    Workbooks.Open Filename:=strFileName
    ActiveSheet.Name = "bitcoin"
    Sheets("bitcoin").Copy After:=Workbooks(ControlFile).Sheets(1)
    Windows(strFileName).Activate
    ActiveWorkbook.Close SaveChanges:=False
    Windows(ControlFile).Activate
End Sub
