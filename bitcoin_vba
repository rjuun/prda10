Option Explicit

Private Declare Function URLDownloadToFile Lib "urlmon" _
Alias "URLDownloadToFileA" (ByVal pCaller As Long, _
ByVal szURL As String, ByVal szFileName As String, _
ByVal dwReserved As Long, ByVal lpfnCB As Long) As Long
Dim Ret As Long

Sub Download()
'QuandlData()
Dim URL As String
Dim Path As String
    URL = "https://www.quandl.com/api/v3/datasets/BITCOIN/BTCEUSD.csv?api_key=P6QLMV4K3VrkT3jsdCP1"
    Path = "C:\Temp\bitcoin.csv"
    Ret = URLDownloadToFile(0, URL, Path, 0, 0)
        If Ret = 0 Then
            MsgBox "File successfully downloaded"
        Else: MsgBox "Unable to download the file"
        End If
End Sub

Sub ImportCSV()
Const strFileName = "C:\Temp\bitcoin.csv"
Dim wbkS As Workbook
Dim wshS As Worksheet
Dim wshT As Worksheet
Set wshT = Worksheets.Add(After:=Worksheets(Worksheets.Count))
Set wbkS = Workbooks.Open(Filename:=strFileName, Format:=",")
Set wshS = wbkS.Worksheets(1)
ws
hS.Range("A1:A8").EntireRow.Delete
wshS.UsedRange.Copy Destination:=wshT.Range("A1")
wbkS.Close SaveChanges:=False
End Sub


Sub OpenData()
Application.DecimalSeparator = ","
Const strFileName = "C:\Temp\bitcoin.csv"
Dim wb As WorkbookSet

wb = Workbooks.Open(strFileName)

End Sub
